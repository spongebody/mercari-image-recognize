## Mercari 商品图片识别接口需求说明
该接口用于识别Mercari平台商品的图片，并返回商品的标题、描述、可能的价格、分类、品牌名称。

**基本流程**
1. 接收图片
2. 请求AI服务（使用openrouter）进行图片识别，获取商品信息，需要返回标题、描述、可能的价格（给出3个可能的价格）、一级分类、品牌名称
3. 根据步骤2获取到的商品信息和分类，去一级分类对应的数据集里找到最匹配的top3的分类，并进行返回，需要返回分类的id和名称
4. 最终需要返回json格式的数据，包含商品的标题、描述、3个可能的价格、3个可能的分类、品牌名称

**分类数据**
mercari的分类数据集的信息如下所示：
```
分类名称 | 条目数量 | 百分比 |
| --- | --- |
キッチン・日用品・その他 | 738 | 9.69% |
スポーツ | 719 | 9.44% |
ハンドメイド・手芸 | 689 | 9.05% |
ゲーム・おもちゃ・グッズ | 660 | 8.67% |
車・バイク・自転車 | 551 | 7.24% |
ホビー・楽器・アート | 517 | 6.79% |
アウトドア・釣り・旅行用品 | 454 | 5.96% |
DIY・工具 | 400 | 5.25% |
ベビー・キッズ | 397 | 5.21% |
ハンドメイド・手芸 | 376 | 4.94% |
家具・インテリア | 348 | 4.57% |
ペット用品 | 316 | 4.15% |
ダイエット・健康 | 278 | 3.65% |
コスメ・美容 | 232 | 3.05% |
スマホ・タブレット・パソコン | 232 | 3.05% |
テレビ・オーディオ・カメラ | 214 | 2.81% |
フラワー・ガーデニング | 158 | 2.08% |
生活家電・空調 | 153 | 2.01% |
チケット | 61 | 0.80% |
本・雑誌・漫画 | 55 | 0.72% |
CD・DVD・ブルーレイ | 45 | 0.59% |
食品・飲料・酒 | 20 | 0.26% |
```
总共有22 个一级分类，7613 条记录，每条记录的格式为：
```
CD・DVD・ブルーレイ > CD > アニメ
DIY・工具 > ドライバー・レンチ > スパナ・レンチ > T形レンチ
DIY・工具 > ドライバー・レンチ > ソケット > その他
...
```

** 品牌数据**
mercari的品牌数据集的信息如下所示：
```
id,name,name_jp,name_en
225nDaWCk4MpMbnFP6a5An,Xmiss,キスミス,Xmiss
227vuRYYdqkMVDwJuJQd5B,GRANDPHASE,グランフェイズ,GRANDPHASE
22AkY5Vrv76PsWr8q6MCu7,Lara Guidotti,ラーラグィドッティ,Lara Guidotti
22AqCQCGPsmBv3vzFMSgvJ,PinkishBeaute,ピンキッシュボーテ,PinkishBeaute
22JwnhFS88dB2xLGX3uNwj,LaCheteau,ラシュトー,LaCheteau
22KeQzuM2NhTCUVruVS6zD,MIKI HOUSE DOUBLEB,ミキハウスダブルビー,MIKI HOUSE DOUBLEB
22PaLNiH4HqjdCeb39xhSE,京橋千疋屋,キョウバシセンビキヤ,Kyobashi Sembikiya
22S3tC7Fxq4pKNA5XPnAVX,ITALICO,イタリコ,ITALICO
...
```
总共有52681条数据。

**难点&重点**
1. 品牌名
通过提示词工程，要求AI在图片识别时尽可能返回 mercari 平台的品牌名称，拿到名称后验证是否在品牌数据集里，如果不在品牌名称字段则返回空字符串
2. top3 分类
- 通过提示词工程，要求AI在图片识别时给商品进行归类，从22个一级分类中找到最匹配的
- 从一级分类的数据集里找到最匹配的top3的分类
- 验证top3的分类是否在分类数据集里，不在返回空，在的话去数据集里找到对应的id和名称
3. 返回内容
严格限定返回格式为json，包含商品的标题、描述、3个可能的价格、3个可能的分类、品牌名称


对于 “5.4 Step 4 – 类目 Top3 匹配逻辑”这一块，目前不想使用向量数据库及其相似度算法，因为有很多类别都非常接近，效果不会太好。我的想法是继续使用LLM来完成这一步，将商品信息和一级分类对应的条目数据都喂给LLM，然后要求LLM返回top3的分类。验证分类是否来自原数据集，验证通过后返回分类的id和名称。
prompt 可以参考下面这个，将其修改为适用于当前根据商品信息来进行分类的场景：
```
You are an e-commerce taxonomy specialist.
Given a source category and candidate target categories from Mercari,
choose the best fit and assign a confidence in [0,1].
Respond with JSON matching the schema:
{best_target_path: str, confidence: float, reason: str,
alternatives: [{target_path: str, confidence: float, reason: str}]}
```
另外，为了达到这一效果，我的类别数据集需要进一步整理吗？需要修改哪些字段吗？